<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>38&nbsp; Linux传奇：终端到操作系统 – podcast-book</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./podcast040.html" rel="next">
<link href="./podcast038.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./podcast039.html"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Linux传奇：终端到操作系统</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">podcast-book</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Java语言的前生今世(上)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Java语言的前生今世(下)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">BT(BitTorrent)的前生今世</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast004.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">任天堂的前生今世(上)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast005.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">任天堂的前生今世(下)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast006.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">智能手机背后的故事(上)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast007.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">智能手机背后的故事(下)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast008.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Doom的前生今世</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast009.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">安卓系统的前生今世</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast010.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">谷歌的扮猪吃老虎</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast011.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">危险的Facebook</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast012.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">第12期：专利不可怕，就怕专利流氓有文化</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast013.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">第13期. 手握爪机向天问——抵制洋货有何难</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast014.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">第14期 钻钻牛角尖——电脑开机都开了啥？</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast015.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">第15期 短平快前女友的照片是怎么晒出去的？</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast016.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">第16期 一个伟大的公司之死</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast017.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">第17期 决战光明顶–编译器的圣战</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast018.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">第18期 Blogger谁从毫末见参天</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast019.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">第19期 苹果换新一次成功的大迁徙</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast020.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">第20期 指令集之争，分久必合</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast021.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">互联网是谁发明？</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">任天堂往事，马里奥之父宫本茂</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">任天堂往事，精灵宝可梦之父田尻智</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">转给苹果用户一段不可不知的历史</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast026.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">转给安卓手机用户，自有土地上开出的罪恶之花</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast027.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">可视化的一生(鸡汤文)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast028.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Unix的起源和长久的发展</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast029.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Unix和里奇留给人类最好的遗产</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast030.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">两个人加六个月做出了一个Unix操作系统</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast031.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Unix火箭的助推器：C语言</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast032.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">BSD版权战争中重获自由的Unix</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast033.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Unix痛恨者手册读后感</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast034.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Linux传奇大鼻子男孩的诞生</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast035.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Linux传奇2：Linus的童年时光</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast036.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Linux传奇：书呆子的中学生涯</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast037.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Linux传奇：Linus上大学</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast038.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Linux传奇：Linus如何在裸机上写软件</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast039.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Linux传奇：终端到操作系统</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast040.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Linux已经进产房了</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast041.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Linux传奇：0.01版Linux出生了</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast042.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">流水线上的兵马俑</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./podcast043.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Linux传奇：吵架史上的一段佳话</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Linux传奇：终端到操作系统</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>在节目正式开始之前，我先来回答一个ID叫“超级炮车”的朋友的问题，这个是“打炮”的那个“炮”，“超级炮车”。还有一个ID叫“家住海边，喜欢浪”的朋友。说真的，我很希望大家每个人都注册一个公众号来写文章，能碰到好多有趣的人或事。目前这两个ID是我最喜欢的两个ID，一个叫“超级炮车”，然后还有一个叫“家住海边，喜欢浪”。</p>
<p>先回答一下这个“超级炮车”读者提到的问题，其实呢也不算回答。因为昨天我发出了那篇《如何在裸机上运行软件》的文章以后，这位热心的读者就和我讨论了很多操作系统的问题。后来还加了微信，讨论了好久。说实在的，我虽然35岁了，而这位叫“超级炮车”的小孩，真的是小孩，刚刚上大学，他对操作系统的很多理解已经远远超过我了，让我非常的佩服，也很欣慰。在我的内心，我还是一个技术宅男。相比于技术，我其实挺讨厌讨论那些经济、政治、金融这种话题，我觉得那都是上层阶级关心的问题。我更喜欢没事折腾一下电脑或者陪我两个小孩玩玩。</p>
<p>我跟这个“超级炮车”讨论的问题其实也很简单，也很有趣。就是说如何编译一个软件，让这个软件可以不借助操作系统运行，就是上一期节目的意思。然后他就提出了这个问题，我觉得也非常好。比方说呢，我们从网上下载一个游戏，比如说《魔兽争霸》或者什么游戏的话，如果没有Windows操作系统，是不是我们没办法让这个游戏运行起来？对啊，你没办法，你下载了之后，你没有操作系统，你就没法让它运行。因为这个软件是要借助操作系统才能装上，然后游戏才能运行。如果一段代码可以直接让它运行在软件上，而恰恰这一段代码又恰好可以做一些事情，比如说它做的事情是管理计算机的硬件资源这件事，那么这段代码就是个操作系统。那如果这段代码不做管理计算机硬件资源的事呢，这就是一个不依赖操作系统的代码。那如何才能做到呢？</p>
<p>其实重点呢就是说你要静态链接所有的依赖，并且规定这个程序内存地址空间的一些顺序。因为现在我们程序员开发的都是非常高层的东西，比如说很不接近底层了，我们都是用IDE（集成开发环境）来开发软件。所以很多同学在编译和链接的时候，就算点一下，它自动就完成了编译和链接。整个过程其实是两个独立的过程，编译是编译，链接是链接，但是现在的编译器呢，都把这两个东西结合在一起了。其实现在的编译器，你用命令的话，都会有以下的一些功能。第一个呢，它实际上是可以指定特定的函数在你最后生成的那个文件中的偏移量。还有一个功能呢，是保存一张符号表，里面就标明了每一个函数的偏移量。知道了这些东西以后呢，如果我们有一个loader的话，就可以直接根据规定的那个偏移量，直接就把那个entry function加载到那里。</p>
<p>比如说呢，如果有年龄比较大的朋友用过MS-DOS的话，像我就用过MS-DOS或者Windows3.1。它的本质是什么？就是一个loader，我一下子就要找到那个安全防护tion，就把它load起来好了。（注：此处“tion”应为识别错误，但根据上下文无法确定正确词汇，可能是“section”或其他相关术语）就不说这个了，我觉得这个问题讨论得非常好，所以我单独说一下。</p>
<p>上一期说了呢，Linux在软盘里就写了一个可以启动的终端模拟器，用来上网、在网上发帖或者看新闻。这个软件的功能当时就是这些，没有其他的功能了。但是Linux非常希望再添加一些功能，比如说它从网上下载或者上传一些文件，但是呢，这个目前的终端仿真器是没法完成这个任务的。因为如果你这个软盘想要存储文件的话，需要一个文件系统。现在我们都知道一些文件格式、文件系统，比如说Windows上常用的文件格式就是NTFS格式或者FAT32，Linux常用的格式有EXT4等等。但是在Linux那个年代，它使用的是软盘。</p>
<p>说实在的，我用软盘的机会也不多，用过，但是不多。我知道它这个格式是FAT12，因为我用电脑的时候，这个软驱就已经渐渐地要退役了。我那时候已经出来U盘了，只是比较小，16兆或者32兆，但总比1.44兆的软盘要好很多。因为我对软驱和软盘了解不多，我就知道它的文件格式，但是实际上其他的也不知道了。但我也不可能为了写这篇文章，再去研究一个已经退役了的文件格式。但是我可以谈谈硬盘，我还是了解一些机械硬盘的。</p>
<p>假设Windows当年是在它的机械硬盘上弄一个文件系统的话，它应该关注哪些技术细节呢？就是硬盘在操作系统里和其他的硬件设备都是一样的，就和我们的显卡和我们的键盘控制器一样。如果你要对硬盘控制器的IO进行操作的话呢，其实都是一样的。硬盘的IO端口也是分成两种，一种叫做命令块寄存器，一种叫做（此处重复，应为另一种寄存器名称，但根据上下文无法确定，可能是“数据块寄存器”或其他相关术语）。简单的来说，你如果先要做的事情，就是先向命令块寄存器中写入正确的值，然后再通过控制块寄存器发送命令就可以了。就这两步。</p>
<p>如果我们买回一个硬件，比如说我们要买个显卡什么的，你装在那个主板上，实际上是先要装驱动程序的。其实硬盘也有驱动程序，只是我们很难说“哎，我买了个硬盘要去装驱动程序”，是因为操作系统都已经帮我们装好了，我们不知道而已。它就是你一装操作系统，它自动地就帮你装好了，它偷偷地帮我们装好了。驱动程序的作用呢，就是隐藏硬件的细节，像其他的使用它。比如说有很多进程使用这个硬盘的话，它在提供一个统一的接口。</p>
<p>当年Linux是完全想写自己的文件系统，因此呢，他还要写一个自己的文件系统的驱动来查看他那台Linux硬盘上的一些组织文件。你如果想要查看的话，你必须要先写一个驱动程序。按照他自传里的话说，它的文件都保存在Minix系统上，这个硬盘嘛，所以呢，这个他是要在软盘里。如果要做的话呢，就需要兼容这个Minix系统，否则的话你完全读不出来。但它在它的自传里呢，也没有透露它的硬盘容量的大小。说实在的，我也很难查到它当年那个硬盘是多少兆的，应该也不大可能100兆不到。但是呢，那个年代的硬盘是一种叫做IDE接口的，这个我是确定的。这个IDE接口是一个有几家公司，包括西部数据啊、康柏、希捷这些公司合作开发的一种标准的接口。</p>
<p>可能那个时候呢，现在我们都使用SATA接口，那时候还没有。为了区别呢，那个年代的接口我们称之为并口硬盘，现在的呢，我们称之为串口硬盘。但他们的祖宗都是在一九七三年IBM开发的一种叫做Winchester硬盘的东西。也就是我们有人会听到过“温盘”，就是这个东西。现在在很多地方呢，仍然可以看到驱动文件。比如说尤其是很多开源的系统，如果你看到有一个驱动文件叫Winter Ter（此处应为识别错误，可能是指某种硬盘驱动的名称，但无法确定正确名称），就这么个驱动文件的话，这个不用想，99%就是这个硬盘驱动，因为它都是有历史遗留问题嘛。以前那个技术叫温彻斯特技术，是IBM搞的。</p>
<p>我大体就讲了一下硬盘。有了硬盘以后，我们再说一下文件系统。比如说FAT32、NTFS这种就是文件系统。当年Linux需要兼容的是一个Minix文件系统。我在微机百科上看了一下，这个Minix文件系统也不是自己独创的，他当年就是学习Unix文件系统的东西。但对这个Minix我也没用过啊，肯定也不懂，但是我可以以FAT32格式来代替。我觉得整个文件系统跟我们教科书上学的一样，虽然不同的名字，但是本质差别不大。</p>
<p>所以我就先说一个大概。比如说我们现在就是玩游戏嘛，想一想如果我们是Linux的话，碰到这个情况应该怎么做？如果你要做一个文件系统呢，从大的方面我们要考虑搞定几件事情。就是说你第一个呢，就要有地方记录硬盘扇区使用的情况；第二呢，就是要有地方记录哪个文件占用了哪个扇区；第三呢，你要有地方存放文件的索引，查找的时候要方便。总结成一句话来说呢，这件事情Linux做了一件什么事情呢？就是他做了一套方法。这套方法呢，就是用于存储、组织和管理计算机文件数据的一套方法。就是文件系统就是这么一件事情。他呢，还是要兼容Minix。</p>
<p>为了开发这个文件系统呢，我们这个可爱的Linux同学呢，就整个放弃了他所有的社交活动，生活就只剩下了吃饭、编程、睡觉。吃饭、编程、睡觉。花了好几个月的时间。他在自传里自己说，整个夏天，他除了编程，什么也没干，才终于搞定了这个文件系统。在开发期间呢，他也沮丧过很多次。从他自己的自传里，我可以挑出一些故事来讲一讲，讲一讲这个Linux当年激情燃烧的岁月，以表达我对Linux无限的敬佩。</p>
<p>他说：“这个项目花了我很大的力气，我的日程安排也成了编程、睡觉、编程、睡觉、编程、吃饭，吃一点椒盐卷饼，再编程、再睡觉、再编程、再洗澡，就是随便匆匆了事，然后再编程。”随着项目逐渐完善，我意识到它越来越像一个操作系统了。于是我改变了想法，不再把它当成一个改进型的终端仿真程序，而是一个可运行的操作系统。既然它的功能已经如此之多，那么只需要再加把劲，它就能破茧成蝶了，变成一个操作系统。</p>
<p>每当我看到这一段的时候，我就非常的感慨。就真的是纯粹是为了兴趣搞文件系统、搞什么的，然后最后就搞出来了一个操作系统。对于喜欢编程的人来说，这个编程是世界上最有趣的事情。对不喜欢编程的人来说，这个可能是世界上最无聊的事情。但对我来说，我觉得编程也要分成两种：一种是你有兴趣编程；另一种是你给谁给的钱多，你就给谁编程。这两种有时候是冲突的，尤其是你为了工作的时候，其实很多时候编程是没有什么乐趣的。因为我干过很多类似没有这种乐趣的编程，其实跟农民工挖个水沟也差不多，就是人家给你画一条线，你挖过去，客户让你怎么干，其实能自由发挥的地方也不多。</p>
<p>长都是叫舅舅。就是这4个人怎么做呢？就是点四次确定，然后弹出一个对话框，有一个文本框，输入自己的名字，然后还要在电脑上给他配一个摄像头，他点确定、输名字，然后再拿着摄像头拍一张是他点的这个人的照片。然后这4个人只有都干了这件事情以后呢，这个钱才能发下去。最后再交给管财务的那个人再点一个确定。</p>
<p>也就是说，整套系统我们又给它加了5个确定的地方，加了5个写名字的地方，还加了5个用摄像头拍照片的地方。</p>
<p>其实，有的时候生活就是这样，也很无奈。有时候我想想，我也就是为了混一口饭吃嘛，人家让你怎么改，你就怎么改，否则的话，你这个系统人家也不给你钱。可能是因为我在现实中有时候也经常碰到这种客户，就是比较刁难嘛。所以我有时候想想，哎，可能我热衷于技术有点是躲避现实的感觉吧。当然我也不知道，但是实际上我还是真心觉得编程很有意思。有时候调试整个bug的时候，调试半天，然后突然找出了这个bug，那个感觉还真是很爽。我也很热衷于学习新的东西啊，各种有用的没用的编程知识、编程故事也知道了一大堆。</p>
<p>所以呢，我就写这个公众号来告诉一些后来者。如果有人喜欢听的话，我还是感觉到比较高兴。虽然这个公众号的人也很少。最后呢，我前一段时间是学习怎么录视频嘛，结果录的还是太差了。因为各种录屏软件我也不会用，我只会普通的录屏，而且废话也太多。</p>
<p>我有一个为期五年的视频录制计划，就是我打算把我知道的这些编程知识都录成视频，打算放3个地方。第一个呢，放百度网盘上，因为这个可以下载，你可以看得比较清楚一点。因为我都是弄的720p或者是1080p的，你可以下载，如果有人看的话。第二个是b站，就是哔哩哔哩这个网站，很多人还不知道哔哩哔哩这个网站的好处，就是它没有广告。然后还有一个是腾讯视频，之所以放腾讯视频呢，是因为你如果在微信公众号里要添加视频链接的话，它只支持腾讯视频。我也不知道有没有广告，看起来好像没有，有的人说又有，我也不知道。但有可能要看广告的话，它只支持这个腾讯的微信公众号，你只能放腾讯的视频。百度的链接呢，我就放在我的公众号里，就在下面好长一串。如果有了我新录制好的视频呢，我就都放在这个地方。如果你关注一下这个文件夹，就应该可以看到。</p>
<p>这期呢，我也就先放在这里。我是录了一个叫《三十分钟讲Python》的视频，就是让大家看一下喜不喜欢这个Python，对不对胃口，但是讲得也不仔细。但是我还是学了很多的技术，怎么去切换镜头啊，怎么把它字体放大缩小。这样作为录视频界的新人，以前录的实在是太烂了，废话也太多。这个是我闭门思过一周多搞出来的嘛，还是非常欢迎大家提意见。</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./podcast038.html" class="pagination-link" aria-label="Linux传奇：Linus如何在裸机上写软件">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Linux传奇：Linus如何在裸机上写软件</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./podcast040.html" class="pagination-link" aria-label="Linux已经进产房了">
        <span class="nav-page-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Linux已经进产房了</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>